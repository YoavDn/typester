import{d as w,c as a,o as l,a as c,t as E,n as b,e as r,r as R,g as L,F as B,_ as Y,h as N,i as $,j as A,k as Z,l as T,m as ee,p as te,w as g,q as se,b as d,s as oe}from"./index.fc737017.js";const ae=w({__name:"Latter",props:{latter:null},setup(_){const n=_,o=a(()=>({correct:n.latter.isCorrect===!0,typo:n.latter.isCorrect===!1,notTyped:n.latter.isCorrect===null}));return(u,s)=>(l(),c("p",{class:b([_.latter,r(o)])},E(_.latter.latter),3))}});const ne={class:"latter"},re=w({__name:"Word",props:{word:null},setup(_){return(n,o)=>(l(!0),c(B,null,R(_.word.latters,u=>(l(),c("div",ne,[L(ae,{latter:u},null,8,["latter"])]))),256))}});const le=Y(re,[["__scopeId","data-v-849873fe"]]),ce=w({__name:"Caret",setup(_){const n=N(),o=$(),u=a(()=>o.getCaretPos),s=a(()=>o.getIslatterEnd),m=a(()=>{if(u.value!==null){const{top:i,left:h,leftEnd:W,right:v}=u.value;return s.value?{top:i+"px",left:W+"px"}:{top:i+"px",left:h+"px"}}}),k=a(()=>({"caret-key-frame":!n.isActive}));return(i,h)=>(l(),c("div",{class:b(["caret",r(k)]),style:A(r(m))},null,6))}});const ue={key:0,class:"overlay"},ie=d("div",{class:"text-modal"},[d("h2",null,"Press any key to continue"),d("h3",null,"Press Enter to reaplay")],-1),de=[ie],_e={class:"test-options-bar flex"},ve={key:0},fe={key:1},pe=["onInput"],me=w({__name:"Test",setup(_){var M;const n=$(),o=N(),u=Z(),s=a(()=>o.getTest),m=a(()=>o.getIsActiveTest),k=a(()=>o.getIsNewTest),i=a(()=>u.getTestLevel),h=a(()=>u.getTestMode),W=a(()=>n.getCaretPos),v=T(null),y=T(null),f=T([]),S=T(null),F=a(()=>{var e,t;return h.value==="words"&&i.value===15?(e=s.value)==null?void 0:e.txt.slice(0,i.value):(t=s.value)==null?void 0:t.txt});(M=y.value)==null||M.scrollTo({top:0,behavior:"smooth"}),ee(()=>{K(),V(),z(),D()}),te(()=>{I()});const K=g(()=>{h.value==="time"&&s.value.time>i.value&&o.finishTest()}),V=g(()=>{k.value===!0&&(o.newTest(),f.value.length>1&&I())}),z=g(()=>{W.value&&U()}),D=g(()=>{if(!s.value||f.value.length<1)return;const{currWord:e}=s.value,t=f.value[e.idx-1];e.idx<1||(s.value.txt[e.idx-1].isCorrect===!1?t.classList.add("word-bad"):s.value.txt[e.idx-1].isCorrect&&t.classList.remove("word-bad"))});function I(){var e,t;(e=v.value)==null||e.focus(),n.setLatterEnd(!1),(t=y.value)==null||t.scrollTo({top:0,behavior:"smooth"}),x()}function G(e){if(v===null||!s.value||f.value.length<1)return;const t=e.target.value;o.handleType(t),v.value.value="",x()}function O(e){var p;const t=e.key;t==="Enter"&&!m.value?(f.value.forEach(C=>{C.classList.remove("word-bad"),x()}),o.reloadTest()):(t==="Backspace"||t==="Escape")&&((p=v.value)==null||p.focus(),o.hendleSpicialKeys(t),x())}function x(){if(y!==null&&s.value){const{currWord:e,currLatter:t}=s.value,p=f.value[e.idx].children[t.idx];n.updatedCaretPos(p,S.value)}}function P(){var e;(e=v.value)==null||e.focus()}function q(){o.activateTest(),P()}function U(){var t;const e=n.getCaretPos;u.getIsOnMinWords||e!==null&&((t=y.value)==null||t.scrollTo({top:e.top,behavior:"smooth"}))}const j=(e,t)=>{e!==null&&(f.value[t]=e)},H=a(()=>{if(!!s.value)return i.value-Math.round(s.value.time)}),J=a(()=>{var e;return((e=s.value)==null?void 0:e.currWord.idx)+"/"+i.value});return(e,t)=>{var p;return l(),c("section",{class:"test-container",onClick:q},[!r(m)&&((p=r(s))==null?void 0:p.currWord.idx)!==0?(l(),c("div",ue,de)):se("",!0),d("div",_e,[d("div",{style:A({opacity:r(m)?1:0}),class:"test-mode"},[r(h)==="time"?(l(),c("h2",ve,E(r(H)),1)):(l(),c("h2",fe,E(r(J)),1))],4)]),d("div",{class:"words-wapper",onClick:P,ref_key:"ElMainContainer",ref:y},[L(ce),d("input",{class:"game-input",tabindex:"0",ref_key:"ElGameInput",ref:v,onKeydown:O,onInput:oe(G,["stop"]),type:"text"},null,40,pe),d("main",{class:"word-container flex",ref_key:"ElWordsContainer",ref:S},[(l(!0),c(B,null,R(r(F),(C,Q)=>(l(),c("div",{class:"word flex",ref_for:!0,ref:X=>j(X,Q),key:C.word},[L(le,{word:C},null,8,["word"])]))),128))],512)],512)])}}});export{me as default};
