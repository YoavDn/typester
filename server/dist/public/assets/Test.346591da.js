import{d as W,c as o,o as i,a as d,t as I,n as k,e as n,r as B,g as P,F as N,_ as ee,h as $,i as A,j as F,k as K,l as T,m as te,p as se,w,q as oe,b as _,s as re}from"./index.bd89c16e.js";const ne=W({__name:"Latter",props:{latter:null},setup(f){const a=f,r=o(()=>({correct:a.latter.isCorrect===!0,typo:a.latter.isCorrect===!1,notTyped:a.latter.isCorrect===null}));return(c,s)=>(i(),d("p",{class:k([f.latter,n(r)])},I(f.latter.latter),3))}});const ae={class:"latter"},le=W({__name:"Word",props:{word:null},setup(f){return(a,r)=>(i(!0),d(N,null,B(f.word.latters,c=>(i(),d("div",ae,[P(ne,{latter:c},null,8,["latter"])]))),256))}});const ce=ee(le,[["__scopeId","data-v-849873fe"]]),ue=W({__name:"Caret",setup(f){const a=$(),r=A(),c=F(),s=o(()=>c.getCaretPos),m=o(()=>c.getIslatterEnd),E=o(()=>a.getRtl),p=o(()=>a.getTestSettings),x=o(()=>{if(s.value!==null){const{top:l,left:v,leftEnd:u,right:L}=s.value;return E.value?m.value?{top:l+"px",left:v+"px"}:{top:l+"px",left:u+"px"}:m.value?{top:l+"px",left:u+"px"}:{top:l+"px",left:v+"px"}}}),y=o(()=>({"caret-key-frame":!r.isActive})),S=o(()=>({"smooth-caret-trans":p.value.smoothCaret}));return(l,v)=>(i(),d("div",{class:k(["caret",n(y),n(S)]),style:K(n(x))},null,6))}});const ie={key:0,class:"overlay"},de=_("div",{class:"text-modal"},[_("h2",null,"Press any key to continue"),_("h3",null,"Press Enter to reaplay")],-1),ve=[de],_e={class:"test-options-bar flex"},fe={key:0},pe={key:1},he=["onInput"],xe=W({__name:"Test",setup(f){var R;const a=F(),r=A(),c=$(),s=o(()=>r.getTest),m=o(()=>r.getIsActiveTest),E=o(()=>r.getIsNewTest),p=o(()=>c.getTestLevel),x=o(()=>c.getTestMode),y=o(()=>c.getRtl),S=o(()=>a.getCaretPos),l=T(null),v=T(null),u=T([]),L=T(null),O=o(()=>{var e,t;return x.value==="words"&&p.value===15?(e=s.value)==null?void 0:e.txt.slice(0,p.value):(t=s.value)==null?void 0:t.txt});(R=v.value)==null||R.scrollTo({top:0,behavior:"smooth"}),te(()=>{V(),z(),D(),G()}),se(()=>{M()});const V=w(()=>{x.value==="time"&&s.value.time>p.value&&setTimeout(()=>r.finishTest())}),z=w(()=>{E.value===!0&&(r.newTest(),u.value.length>1&&M())}),D=w(()=>{S.value&&H()}),G=w(()=>{if(!s.value||u.value.length<1)return;const{currWord:e}=s.value,t=u.value[e.idx-1];e.idx<1||(s.value.txt[e.idx-1].isCorrect===!1?t.classList.add("word-bad"):s.value.txt[e.idx-1].isCorrect&&t.classList.remove("word-bad"))});function M(){var e,t;(e=l.value)==null||e.focus(),a.setLatterEnd(!1),(t=v.value)==null||t.scrollTo({top:0,behavior:"smooth"}),g()}function q(e){if(l===null||!s.value||u.value.length<1)return;const t=e.target.value;r.handleType(t),l.value.value="",g()}function U(e){var h;const t=e.key;t==="Enter"&&!m.value?(u.value.forEach(C=>{C.classList.remove("word-bad"),g()}),r.reloadTest()):(t==="Backspace"||t==="Escape")&&((h=l.value)==null||h.focus(),r.hendleSpicialKeys(t),g())}function g(){if(v!==null&&s.value){const{currWord:e,currLatter:t}=s.value,h=u.value[e.idx].children[t.idx];a.updatedCaretPos(h,L.value)}}function b(){var e;(e=l.value)==null||e.focus()}function j(){r.activateTest(),b()}function H(){var t;const e=a.getCaretPos;c.getIsOnMinWords||e!==null&&((t=v.value)==null||t.scrollTo({top:e.top,behavior:"smooth"}))}const J=(e,t)=>{e!==null&&(u.value[t]=e)},Q=o(()=>{if(!!s.value)return p.value-Math.round(s.value.time)}),X=o(()=>{var e;return((e=s.value)==null?void 0:e.currWord.idx)+"/"+p.value});return(e,t)=>{var h;return i(),d("section",{class:"test-container",onClick:j},[!n(m)&&((h=n(s))==null?void 0:h.currWord.idx)!==0?(i(),d("div",ie,ve)):oe("",!0),_("div",_e,[_("div",{style:K({opacity:n(m)?1:0}),class:"test-mode"},[n(x)==="time"?(i(),d("h2",fe,I(n(Q)),1)):(i(),d("h2",pe,I(n(X)),1))],4)]),_("div",{class:"words-wapper",onClick:b,ref_key:"ElMainContainer",ref:v},[P(ue),_("input",{class:"game-input",tabindex:"0",ref_key:"ElGameInput",ref:l,onKeydown:U,onInput:re(q,["stop"]),type:"text"},null,40,he),_("main",{class:k(["word-container flex",{"flex-reverse":n(y)}]),ref_key:"ElWordsContainer",ref:L},[(i(!0),d(N,null,B(n(O),(C,Y)=>(i(),d("div",{class:k(["word flex",{"flex-reverse":n(y)}]),ref_for:!0,ref:Z=>J(Z,Y),key:C.word},[P(ce,{word:C},null,8,["word"])],2))),128))],2)],512)])}}});export{xe as default};
